- Environment 
On this PoC using lab with private network 

- Objective
To test restrict user to certain domain

- Device Information
Zimbra Open Source Editon		: Version 8.7.1
                                  
- Step by step config postfix
1. Access the server and set directory to /opt/zimbra/conf, then edit file postfix_recipient_restrictions.cf using vi/vim editor, before making changes should backup first
2. Add the following line "check_sender_access lmdb:/opt/zimbra/common/conf/restricted_senders" without quotes to file configuration then save and exit 
3. Still same on directory /opt/zimbra/conf, now edit the file zmconfigd.cf using vi/vim editor
Add two line folowing line before word "RESTART mta" 
POSTCONF	smtpd_restriction_classes	local_only
POSTCONF	local_only	FILE	postfix_check_recipient_access.cf
RESTART mta
5. Now create file postfix_check_recipient_access.cf on /opt/zimbra/conf 
Add the following line to file configuration above then save and exit
check_recipient_access lmdb:/opt/zimbra/common/conf/local_domains, reject
6. Create file restricted_senders on /opt/zimbra/common/conf 
add list all the users, whom you want to restrict
test02@dtclab.com	local_only
7. Create a file /opt/zimbra/common/conf/local_domains and list all the domains where restricted users allowed to sent mails 
Add the following line to file configuration above then save and exit
dtclab.com	OK
8. Enter in file /opt/zimbra/conf/zmconfigd/smtpd_recipient_restrictions.cf add the following line to file configuration
check_sender_access lmdb:/opt/zimbra/common/conf/restricted_senders
9. Next, run this following commands 
su - zimbra
postmap /opt/zimbra/common/conf/restricted_senders
postmap /opt/zimbra/common/conf/local_domains
zmmtactl stop
zmmtactl start

- Validation
1. Test email from internal to external domain from webmail client should be success with rejected email bounce
